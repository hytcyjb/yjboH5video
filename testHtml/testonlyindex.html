<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>从样式开始测试00</title>
    <!--<script src='jquery-3.1.1.min.js'></script>-->
    <script src='../jquery-2.1.0.js'></script>
    <!--字体库：file:///D:/89mc文件/平时文档/download/font_6hm4p5ql8s13jtt9/demo_fontclass.html-->
    <link rel="stylesheet" type="text/css" href="../css/iconfont.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_zg5rtrimrmvon7b9.css">
</head>
<body >
<script type="text/javascript">

    window.onload = function () {

        var  videoBox = document.getElementById("video_box");
        var videoId = document.getElementById("video_id");
        var progressLine = document.getElementById("progress_line");
        var backId = document.getElementById("back_id");
        var progressImg = document.getElementById("progress_img");
        var header = document.getElementById("header");
        var footer = document.getElementById("footer");
        var playId = document.getElementById("play_id");
        var fullId = document.getElementById("full_id");
        var titleId = document.getElementById("title_id");

        var screenW = 0;//这是变量
        var screenH =  0;
        var screenW0 = document.documentElement.clientWidth;//这是定量
        var screenH0 =  document.documentElement.clientHeight;
//        alert("竖屏=012=="+screenH0+"===="+screenW0);//588--393  636-393  660 393
        screenW = screenW0;//这是变量
         screenH =  screenH0;
        changeVideoW();
        otherCaulue();

        playId.onclick = function () {
            //头尾布局隐藏;
            if (header.hidden){
                header.hidden = false;
                footer.hidden =  false;
            }else {
                header.hidden = true;
                footer.hidden =  true;
            }
        }
        fullId.onclick = function () {
            if ("全屏" == fullId.innerHTML){
                fullId.innerHTML = "小屏";
                changeVideoH();
//                window.location.reload();
//                alert("---ganhane--")
            }else if ("小屏" == fullId.innerHTML){
                fullId.innerHTML = "全屏";
                changeVideoS();
//                alert("---ganhane--")
            }

        }
        titleId.onclick = function () {
            window.location.reload();
        }

        window.addEventListener('orientationchange', function(event){
            //第一次不调用事件，之和调用事件
            if ( window.orientation == 180 || window.orientation==0 ) {
                screenW = screenW0;
                 screenH = screenH0;
//                screenW = 393;
//                 screenH = 660;
                alert("竖屏==="+screenH0+"===="+screenW0);//321--663  663-369
                //changeOriP(screenH,screenW)
                fullId.hidden = false;
                changeVideoH();
                changeVideoW();
                otherCaulue();
            }
            if( window.orientation == 90 || window.orientation == -90 ) {

                screenW = screenH0+2;//获取的值得调换--减去边框的间距
                screenH =  screenW0-2;//减去边框的间距
//                screenW = 662//获取的值得调换--减去边框的间距
//                screenH =  391;//减去边框的间距
                alert("横屏12==="+screenH0+"===="+screenW0);//591-393  393-639
                fullId.innerHTML = "小屏";
                fullId.hidden = true;
//                changeOriL();
                changeVideoH();
                changeVideoW();
                otherCaulue();
            }
        });

        /***
         * 竖屏时获取手机的长和宽
         * 通过获取手机的尺寸以此设置视频的宽度；
         * @author yjbo
         */
        function changeVideoW() {
            //根据屏幕进行尺寸配置
            videoBox.style.width = screenW - 2 +"px";//2是边框的宽度左右2边之和
            header.style.width = screenW -2 +"px";//2是边框的宽度左右2边之和
            footer.style.width = screenW  -2 +"px";//2是边框的宽度左右2边之和
            progressLine.style.width = screenW - progressLine.offsetLeft * 2 +"px";

        }
        /***
         * 竖屏的大屏---竖屏使用1
         * 设置视频的全屏模式的高度；
         * @author yjbo
         */
        function changeVideoH() {
            //根据屏幕进行尺寸配置
            videoBox.style.height = screenH+"px";
            videoId.style.height = screenH - videoId.offsetLeft * 2 +"px";
        }
        /***
         * 竖屏的大屏---横屏使用2
         * 设置视频的全屏模式的高度；
         * @author yjbo
         */
        function changeVideoH2() {
            //根据屏幕进行尺寸配置
            videoBox.style.height = screenH+"px";//这里得减去手机的状态栏的宽度，高度
            videoId.style.height = screenH +"px";
        }
        /***
         * 竖屏的小屏
         * 设置视频的全屏模式的高度；
         * @author yjbo
         */
        function changeVideoS() {
            //根据屏幕进行尺寸配置
            videoBox.style.height = 240+"px";
            videoId.style.height = 220 +"px";
            changeVideoW();
            otherCaulue();
        }
        /***
         * 横屏时：(横竖屏切换)
         *
         * 设置视频的全屏模式的高度，宽度；
         * @author yjbo
         */
        function changeOriL() {
            //根据屏幕进行尺寸配置
            videoBox.style.width =  screenW - 2 +"px";//2是边框的宽度左右2边之和
            header.style.width = screenW -2 +"px";//2是边框的宽度左右2边之和
            footer.style.width = screenW  -2 +"px";//2是边框的宽度左右2边之和
            progressLine.style.width = screenW - progressLine.offsetLeft * 2 +"px";
            videoBox.style.height = screenH +"px";
            videoId.style
        }
//        /***
//         * 竖屏时：(横竖屏切换)
//         *
//         * 设置视频的全屏模式的高度，宽度；
//         * @author yjbo
//         */
//        function changeOriL() {
//            //根据屏幕进行尺寸配置
//            videoBox.style.width = screenH - 2 +"px";//2是边框的宽度左右2边之和
//            header.style.width = screenH -2 +"px";//2是边框的宽度左右2边之和
//            footer.style.width = screenH  -2 +"px";//2是边框的宽度左右2边之和
//            progressLine.style.width = screenH - progressLine.offsetLeft * 2 +"px";
//            videoBox.style.height = screenW +"px";
//
//        }
        var  test;
        var  total;
        function otherCaulue() {
            //算法
            var vidBoxW = videoBox.width || videoBox.offsetWidth || videoBox.clientWidth || videoBox.scrollWidth;//取第一个
            videoId.style.width = vidBoxW - 20 +"px";
            /*var wid = progressBox.style.width || progressBox.width || progressBox.offsetWidth || progressBox.clientWidth || progressBox.scrollWidth + videoBox.border.width;*/
              test = progressImg.offsetLeft;
             total = progressLine.offsetWidth + progressImg.offsetLeft;
        }

        //点击事件
        backId.onclick = function () {
            test = test+5;
            if (test > total){               test = 0;            }
            progressImg.style.left = test +"px";
        }


        /*--------------------------------------加入点击事件-------------------------------------------*/
        video1.controls = false;
        video1.poster = "http://image.89mc.com/bjd/knowledge/img/cabc648d-9f9f-41d6-9298-f739bb0dda16.jpg";
        changeProgress();

        /*这是跳转视频播放进度*/
        function changeProgress() {
            outer.addEventListener('touchstart', touchSatrt, false);
            outer.addEventListener('touchmove', touchMove, false);
            outer.addEventListener('touchend', touchEnd, false);
            var disX = 0;
            var startX,//触摸时的坐标
//                    startY,
                x, //滑动的距离
//                    y,
//                    aboveY=0; //设一个全局变量记录上一次内部块滑动的位置
                aboveX = 0; //设一个全局变量记录上一次内部块滑动的位置


            function touchSatrt(e) {//触摸
                e.preventDefault();
                var touch = e.touches[0];
                //startY = touch.pageY;   //刚触摸时的坐标
                startX = touch.pageX;
            }

            function touchMove(e) {//滑动
                e.preventDefault();
                var touch = e.touches[0];
                // y = touch.pageY - startY;//滑动的距离
                x = touch.pageX - startX;
                //  inner.style.top=aboveY+y+"px"; //这一句中的aboveY是inner上次滑动后的位置
                var finalX = aboveX + x;//最终x轴的坐标
                if (finalX < 0) {
                    finalX == 0;
                } else if (x > outer.offsetWidth - inner.offsetWidth) {
                    finalX == outer.offsetWidth - inner.offsetWidth;
                }
                inner.style.left = finalX + "px";
                /*  /!*设置时间*!/
                 video1.currentTime = finalX * video1.duration /(outer.offsetWidth - inner.offsetWidth);*/
                seektime(finalX, outer.offsetWidth - inner.offsetWidth);
            }

            function touchEnd(e) {//手指离开屏幕
                e.preventDefault();
                // aboveY=parseInt(inner.style.top);//touch结束后记录内部滑块滑动的位置 在全局变量中体现 一定要用parseInt()将其转化为整数字;
                aboveX = parseInt(inner.style.left);
            }//
        }
    }

</script>
<style type="text/css">
    * {margin: 0;padding: 0;}
    #video_box{height: 240px;  background: red;border: 1px solid #000000;position:absolute; }/*width: 391px;*/
    #video_id{ height:  220px;background: green;margin:  10px 10px;}
    #header{ background: black;position: absolute;top: 0px;}/*width: 391px;*/
    #footer{ height: 50px;background: black;position: absolute;bottom: 0px;}/*width: 391px;*/
    #progress_line{ height: 5px;background: gray; margin:  7px 10px;position: absolute}/*width: 373px;*/
    #progress_img{ height: 15px;width: 15px;left: 0px;position: absolute;margin:  -5px -5px;}
    #play_id{ color: red; float: left;padding: 5px;}

    /*@media all and (orientation : landscape) {
        h2{color:red;}!*横屏时字体红色*!
    }
    @media all and (orientation : portrait){
        h2{color:green;}!*竖屏时字体绿色*!
    }*/

</style>

<div id="video_box" style="overflow: hidden;background: red">
    <video
            id="video_id" preload src="http://video.89mc.com/89mc/knowledge/video/93c2d547-e0a8-4559-89c5-bb4565e8bf8d.mp4"
            poster = "https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1489288875&di=c25af3ef4886eb3a20aa4e9bb1817824&imgtype=jpg&er=1&src=http%3A%2F%2Fpic.58pic.com%2F58pic%2F15%2F62%2F29%2F07k58PICEPT_1024.jpg"
            class="video"></video>
    <div id="header">
        <div id="back_id" style="color: red;float: left;padding: 5px;">《返回</div>
        <div id="title_id" style="color: red;float: left;padding: 5px 0px 5px 10px; ">标题：XXX</div>
    </div>
    <div id="footer">
        <div id="progress_line">
            <img src="../img/round_16px.png" id="progress_img">
        </div>
        <div style=" width: 100%;margin:  15px 0px;">
            <div id="play_id" >播放</div>
            <div id="current_time_id"  style="color: red;float: left;padding: 5px;">00:00:00</div>
            <div  style="color: red;float: left;padding: 5px;">/</div>
            <div id="total_time_id"  style="color: red;float: left;padding: 5px;">00:00:00</div>
            <div id="full_id"  style="color: red;float: right;padding: 5px;">全屏</div>
        </div>
    </div>

</div>
</body>
</html>